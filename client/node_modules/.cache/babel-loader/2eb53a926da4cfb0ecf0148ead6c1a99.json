{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Jahanvi Chaudhary/Desktop/webRTC-advanced/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Jahanvi Chaudhary/Desktop/webRTC-advanced/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Jahanvi Chaudhary/Desktop/webRTC-advanced/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import SwitchImg from\"../../resources/images/switchToScreenSharing.svg\";import LocalScreenSharingPreview from\"./LocalScreenSharingPreview\";import*as webRTCHandler from\"../../utils/webRTCHandler\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var constraints={audio:false,video:true};var SwitchToScreenSharingButton=function SwitchToScreenSharingButton(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isScreenSharingActive=_useState2[0],setIsScreenSharingActive=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),screenSharingStream=_useState4[0],setScreenSharingStream=_useState4[1];var handleScreenShareToggle=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var stream;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(isScreenSharingActive){_context.next=14;break;}stream=null;_context.prev=2;_context.next=5;return navigator.mediaDevices.getDisplayMedia(constraints);case 5:stream=_context.sent;_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](2);console.log(\"error occurred when trying to get an access to screen share stream\");case 11:if(stream){setScreenSharingStream(stream);webRTCHandler.toggleScreenShare(isScreenSharingActive,stream);setIsScreenSharingActive(true);// execute here function to switch the video track which we are sending to other users\n}_context.next=18;break;case 14:webRTCHandler.toggleScreenShare(isScreenSharingActive);setIsScreenSharingActive(false);// stop screen share stream\nscreenSharingStream.getTracks().forEach(function(t){return t.stop();});setScreenSharingStream(null);case 18:case\"end\":return _context.stop();}}},_callee,null,[[2,8]]);}));return function handleScreenShareToggle(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"video_button_container\",children:/*#__PURE__*/_jsx(\"img\",{src:SwitchImg,onClick:handleScreenShareToggle,className:\"video_button_image\"})}),isScreenSharingActive&&/*#__PURE__*/_jsx(LocalScreenSharingPreview,{stream:screenSharingStream})]});};export default SwitchToScreenSharingButton;","map":{"version":3,"names":["React","useState","LocalScreenSharingPreview","webRTCHandler","constraints","audio","video","SwitchToScreenSharingButton","isScreenSharingActive","setIsScreenSharingActive","screenSharingStream","setScreenSharingStream","handleScreenShareToggle","stream","navigator","mediaDevices","getDisplayMedia","console","log","toggleScreenShare","getTracks","forEach","t","stop","SwitchImg"],"sources":["C:/Users/Jahanvi Chaudhary/Desktop/webRTC-advanced/client/src/RoomPage/VideoSection/SwitchToScreenSharingButton.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport SwitchImg from \"../../resources/images/switchToScreenSharing.svg\";\r\nimport LocalScreenSharingPreview from \"./LocalScreenSharingPreview\";\r\nimport * as webRTCHandler from \"../../utils/webRTCHandler\";\r\n\r\nconst constraints = {\r\n  audio: false,\r\n  video: true,\r\n};\r\n\r\nconst SwitchToScreenSharingButton = () => {\r\n  const [isScreenSharingActive, setIsScreenSharingActive] = useState(false);\r\n  const [screenSharingStream, setScreenSharingStream] = useState(null);\r\n\r\n  const handleScreenShareToggle = async () => {\r\n    if (!isScreenSharingActive) {\r\n      let stream = null;\r\n      try {\r\n        stream = await navigator.mediaDevices.getDisplayMedia(constraints);\r\n      } catch (err) {\r\n        console.log(\r\n          \"error occurred when trying to get an access to screen share stream\"\r\n        );\r\n      }\r\n      if (stream) {\r\n        setScreenSharingStream(stream);\r\n\r\n        webRTCHandler.toggleScreenShare(isScreenSharingActive, stream);\r\n        setIsScreenSharingActive(true);\r\n        // execute here function to switch the video track which we are sending to other users\r\n      }\r\n    } else {\r\n      webRTCHandler.toggleScreenShare(isScreenSharingActive);\r\n      setIsScreenSharingActive(false);\r\n\r\n      // stop screen share stream\r\n      screenSharingStream.getTracks().forEach((t) => t.stop());\r\n      setScreenSharingStream(null);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"video_button_container\">\r\n        <img\r\n          src={SwitchImg}\r\n          onClick={handleScreenShareToggle}\r\n          className=\"video_button_image\"\r\n        />\r\n      </div>\r\n      {isScreenSharingActive && (\r\n        <LocalScreenSharingPreview stream={screenSharingStream} />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SwitchToScreenSharingButton;\r\n"],"mappings":"6bAAA,MAAOA,MAAP,EAAgBC,QAAhB,KAAgC,OAAhC,C,wEAEA,MAAOC,0BAAP,KAAsC,6BAAtC,CACA,MAAO,GAAKC,cAAZ,KAA+B,2BAA/B,C,6IAEA,GAAMC,YAAW,CAAG,CAClBC,KAAK,CAAE,KADW,CAElBC,KAAK,CAAE,IAFW,CAApB,CAKA,GAAMC,4BAA2B,CAAG,QAA9BA,4BAA8B,EAAM,CACxC,cAA0DN,QAAQ,CAAC,KAAD,CAAlE,wCAAOO,qBAAP,eAA8BC,wBAA9B,eACA,eAAsDR,QAAQ,CAAC,IAAD,CAA9D,yCAAOS,mBAAP,eAA4BC,sBAA5B,eAEA,GAAMC,wBAAuB,4FAAG,mJACzBJ,qBADyB,0BAExBK,MAFwB,CAEf,IAFe,uCAIXC,UAAS,CAACC,YAAV,CAAuBC,eAAvB,CAAuCZ,WAAvC,CAJW,QAI1BS,MAJ0B,8FAM1BI,OAAO,CAACC,GAAR,CACE,oEADF,EAN0B,QAU5B,GAAIL,MAAJ,CAAY,CACVF,sBAAsB,CAACE,MAAD,CAAtB,CAEAV,aAAa,CAACgB,iBAAd,CAAgCX,qBAAhC,CAAuDK,MAAvD,EACAJ,wBAAwB,CAAC,IAAD,CAAxB,CACA;AACD,CAhB2B,+BAkB5BN,aAAa,CAACgB,iBAAd,CAAgCX,qBAAhC,EACAC,wBAAwB,CAAC,KAAD,CAAxB,CAEA;AACAC,mBAAmB,CAACU,SAApB,GAAgCC,OAAhC,CAAwC,SAACC,CAAD,QAAOA,EAAC,CAACC,IAAF,EAAP,EAAxC,EACAZ,sBAAsB,CAAC,IAAD,CAAtB,CAvB4B,oEAAH,kBAAvBC,wBAAuB,0CAA7B,CA2BA,mBACE,wCACE,YAAK,SAAS,CAAC,wBAAf,uBACE,YACE,GAAG,CAAEY,SADP,CAEE,OAAO,CAAEZ,uBAFX,CAGE,SAAS,CAAC,oBAHZ,EADF,EADF,CAQGJ,qBAAqB,eACpB,KAAC,yBAAD,EAA2B,MAAM,CAAEE,mBAAnC,EATJ,GADF,CAcD,CA7CD,CA+CA,cAAeH,4BAAf"},"metadata":{},"sourceType":"module"}